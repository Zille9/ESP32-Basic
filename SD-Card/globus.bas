5 CUR 0
10 CLS 
12 RESTORE 
15 GOTO 210
20 Y=R*CP:X=Y*CL:Y=Y*SL:Z=R*SP
30 XX=(AX*X)+(AY*Y)+(AZ*Z):YY=(BX*X)+(BY*Y)+(BZ*Z)
40 ZZ=(CX*X)+(CY*Y)+(CZ*Z)
42 IF YY>0 THEN FB=0:FA=0:RETURN 
50 XB=XC+XX+H:YB=YC-ZZ+H:FB=1
60 IF FA=0 THEN XA=XB:YA=YB:FA=1:RETURN 
65 REM  --------- GERADE ---------
70 IF XB=XA THEN U=1E+38:GOTO 110
80 U=(YB-YA)/(XB-XA)
85 IF ABS (U)>1 THEN GOTO 110
90 Y=YA+H: T=SGN (XB-XA)
95 IF T<0 THEN U=-U
100 FOR SX=XA TO XB STEP T
102 PSET SX,255-INT (Y):Y=Y+U
105 NEXT SX:GOTO 130
110 X=XA+H:U=1/U:T=SGN (YB-YA)
112 IF T<0 THEN U=-U
120 FOR SY=YA TO YB STEP T
122 PSET INT (X),255-SY:X=X+U
125 NEXT SY
130 FA=FB:XA=XB:YA=YB:RETURN 
135 REM   -------- KREIS ----------
140 YB=0:D=INT (R/SQR (2)+H):XB=R*R:X=R:RB=XB+D
150 FOR SY=0 TO D
152 IF YB+XB>RB THEN XB=XB-X-X+1:X=X-1
160 PSET XC+X,255-YC+SY:PSET XC+SY,255-YC+X
170 PSET XC-SY,255-YC+X:PSET XC-X,255-YC+SY
180 PSET XC-X,255-YC-SY:PSET XC-SY,255-YC-X
190 PSET XC+SY,255-YC-X:PSET XC+X,255-YC-SY:YB=YB+SY+SY+1
200 NEXT SY:RETURN 
205 REM  --------- MAIN ----------
210 PRINT " R.Zielinski"
220 PRINT "Alle Winkel in Grad":BM=PI()/180
230 INPUT"Geografische Laenge:";CW:C=-(CW+90)*BM
240 INPUT"Geografische Breite:";AW:A=-AW*BM
250 INPUT"Neigung der Achse  :";BW:B=-BW*BM
260 INPUT"Abstand der Kreise :";QW:Q=QW*BM
265 PEN 60
270 CLS :O=4:XC=190
275 YC=134:R=116
278 H=0.5:GOSUB 140
280 SA=SIN (A):SB=SIN (B):SC=SIN (C)
290 CA=COS (A):CB=COS (B):CC=COS (C)
300 AX=CB*CC:AY=-CB*SC:AZ=SB
310 BX=CA*SC+SA*SB*CC:BY=CA*CC-SA*SB*SC
320 BZ=-SA*CB:CX=SA*SC-CA*SB*CC
330 CY=SA*CC+CA*SB*SC:CZ=CA*CB:FA=0:CD=1
335 REM -------- KARTE ----------
340 FOR J=1 TO 292
341 READ A,B
342 IF A=.1 THEN DA=B:A=AA:B=BA:CD=0
350 IF CD=1 THEN AA=A:BA=B:CD=-1
360 L=A*BM: P=-B*BM: CL=COS (L):SL=SIN(L):CP=COS(P):SP=SIN(P):GOSUB 20
370 IF CD=0 THEN A=DA:READ B:CD=1:FA=0:GOTO 350
380 NEXT J
385 REM  -------- LAENGENKREISE -----
390 FOR L=0 TO PI()-Q STEP Q
395 FA=0:CL=COS(L):SL=SIN(L)
400 FOR P=0 TO 2*PI()+BM STEP 2.5*BM
405 CP=COS (P):SP=SIN(P):GOSUB 20
410 NEXT P
412 NEXT L
415 REM  -------- BREITENKREISE -----
420 FOR P=-PI()/2+Q TO PI()/2-Q STEP Q
422 FA=0:CP=COS(P):SP=SIN(P)
430 FOR L=0 TO 2*PI()+BM STEP 2.5*BM
432 CL=COS(L):SL=SIN(L):GOSUB 20
440 NEXT L
441 NEXT P
442 PEN 60
444 PRINT "Laenge  :";CW
445 PRINT "Breite  :";AW
446 PRINT "Neigung :";BW
448 PEN 48
450 POS 1,29:PRINT "Nochmal? J/N";
452 KO=INKEY 
453 IF KO=ASC ("j") THEN GOTO 10
455 IF KO=ASC("n") THEN CUR1:END
470 GOTO 452
485 REM  ------------ DATEN ---------
490 DATA 355,50,1,51,2,52,358,56,359,57,357,58,353,58,355,55,356,55,.1,28,72
500 DATA 15,68,9,63,5,62,6,58,8,58,10,59,12,56,11,56,11,57,9,56,9,54,6,53,3,51
510 DATA 356,48,358,45,358,43,352,43,352,36,355,35,358,36,4,44,6,44,9,45,16
520 DATA 39,16,38,13,38,15,37,18,39,17,40,18,41,19,40,13,44,14,45,19,42,20,40
530 DATA 23,36,25,38,24,40,26,41,27,36,37,36,36,32,21,33,21,32,11,33,12,34
540 DATA 357,33,355,34,342,20,342,11,351,5,10,5,8,0,13,-8,12,-18,18,-24
550 DATA 28,-24,41,-15,40,-5,52,12,43,12,38,20,34,28,43,12,58,18,60,22,51,23
560 DATA 48,30,68,23,77,8,80,10,80,7,82,8,80,10,80,15,90,22,95,16,97,17,99,8
570 DATA 104,2,100,13,106,8,110,13,106,20,109,21,109,19,121,27,121,40
580 DATA 124,39,126,33,130,35,131,41,140,48,140,57,160,61,155,51
590 DATA 163,55,190,67,130,72,95,82,95,76,69,69,35,65,33,67,38,67
600 DATA 42,68,.1,12,54,13,55,15,54,21,55,23,59,30,60,22,61,26,66,24,66
610 DATA 16,55,.1,23,35,26,35,.1,32,35,34,35,.1,44,-25,47,-25,50,-12,44,-18
620 DATA .1,165,-47,172,-47,178,-38,172,-35,172,-40,.1,128,0,141,-9,153,-12
630 DATA 145,-5,.1,118,9,125,5,126,11,122,19,.1,90,8,107,-8,126,-10,106,-5
640 DATA .1,109,2,110,-3,117,-4,119,8,.1,118,-5,123,-5,125,2,120,2,.1,130,30
650 DATA 140,36,145,45,142,45,142,55,138,38,130,33,.1,49,38,55,37,51,45,54,48
660 DATA 48,47,.1,28,42,42,42,36,44,39,47,34,43,36,44,30,46,31,46,.1,350,51
670 DATA 353,53,354,55,353,56,350,53,.1,51,-67,102,-66,140,-67,172,-72
680 DATA 160,-81,210,-85,200,-76,225,-75,300,-63,298,-78,354,-71
690 DATA .1,315,60,338,70,345,82,330,84,295,81,290,76,300,75,312,62
700 DATA .1,346,63,346,68,336,67,337,63,.1,18,76,32,80,10,79,.1,50,72,55,71
710 DATA 69,78,.1,276,22,278,23,295,20,280,18,278,22,.1,288,13,283,9
720 DATA 279,9,276,11,276,15,272,17,273,22,270,21,269,19,263,20,263,28
730 DATA 277,30,279,24,278,31,307,48,296,60,282,63,280,51,265,60,280,70
740 DATA 286,68,282,63,296,62,298,66,280,74,300,83,228,70,200,70,193,67
750 DATA 195,62,202,57,190,53,215,60,235,48,236,35,250,22,245,32,255,18,273,12
760 DATA 279,8,283,8,278,-5,290,-19,283,-52,292,-55,296,-54,292,-51,294,-47
770 DATA 293,-45,315,-23,320,-23,322,-12,325,-6,310,0,308,5,298,11
780 DATA .1,114,-22,132,-12,137,-12,140,-16,142,-11,152,-26,148,-43,135,-35
790 DATA 115,-35,.1,9,43,9,42,8,41,8,39,10,40,.1,-2,60,-2,62,.1,-7,63,-7,65
